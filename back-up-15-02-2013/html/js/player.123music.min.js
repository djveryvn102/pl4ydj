function volume_sound_effect(t){settings.se_volume=20*t/100,$.cookie("player_settings",JSON.stringify(settings),{expires:365,path:"/"}),$(".volume-level").removeClass("active"),$(".volume-level").each(function(e){t>e&&$(this).addClass("active")}),$("#se-volume-text").text(20*t),$(".sound-effect.active").each(function(){document.getElementById($(this).attr("id")).volume=settings.se_volume})}function set_media(t){if(jplayer_pro.jPlayer("setMedia",{mp3:t}),settings.auto_play){jplayer_pro.jPlayer("play");var e=void 0===document.ontouchstart?"click":"touchstart",s=function(){jplayer_pro.jPlayer("play"),document.documentElement.removeEventListener(e,s,!0)};document.documentElement.addEventListener(e,s,!0)}}function stop_sound_effect(){$(".sound-effect").each(function(){document.getElementById($(this).attr("id")).pause()})}function start_sound_effect(){$(".sound-effect.active").each(function(){document.getElementById($(this).attr("id")).play()})}function play_song(t){params.current_song_id=t,$.ajax({url:base_url+"ajax/song/sources/"+t,dataType:"json",success:function(t){t.status&&(console.log(t.sources),params.sources=t.sources,params.total_sources=params.sources.length,current_sources=params.sources[0],sources_id=params.sources[0].id,$("#quality-list").empty(),load_sources(),$("#lyrics-title").empty()&&($("#lyrics-title").html('Lyrics "'+t.name+'"'),""!==t.lyrics?$("#lyrics-content").html(t.lyrics):$("#lyrics-content").html("Updating...")))}})}function load_sources(){params.link_128=current_sources.link_128,params.link_320="undefined"!=typeof current_sources.link_320?current_sources.link_320:"";var t=$(".play-about .xtitle").text().trim();$("#download-list").empty(),$("#quality-list").empty(),""!==params.link_320?($("#quality-list").append('<div data-quality="320" class="pcqt-item quality-item active">320kbps</div>'),$("#quality-list").append('<div data-quality="128" class="pcqt-item quality-item">128kbps</div>'),$("#download-list").append('<p><a download="'+t+'.mp3" target="_blank" data-quality="320" href="'+params.link_320+'" class="btn btn-block btn-sm btn-primary download-item">320kbps</a></p>'),$("#download-list").append('<p><a download="'+t+'.mp3" target="_blank" data-quality="128" href="'+params.link_128+'" class="btn btn-block btn-sm btn-primary download-item">128kbps</a></p>'),$("#quality-selected").text("320kbps"),set_media(params.link_320)):""!==params.link_128&&($("#quality-list").append('<div data-quality="128" class="pcqt-item quality-item active">128kbps</div>'),$("#download-list").append('<p><a download="'+t+'.mp3" target="_blank" data-quality="128" href="'+params.link_128+'" class="btn btn-block btn-sm btn-primary download-item">128kbps</a></p>'),$("#quality-selected").text("128kbps"),set_media(params.link_128)),$(".quality-item").click(function(){$(".quality-item").removeClass("active"),$(this).addClass("active");var t=$(this).attr("data-quality");$("#quality-selected").text(t+"kbps");var e=get_sources(t);set_media(e)})}function get_sources(t){var e={128:params.link_128,320:params.link_320};return e[t]}function init_control(){"album"==params.type||($("#control-next").remove(),$("#control-prev").remove(),$("#control-random").remove()),settings.auto_play||($(".pc-auto").addClass("disable"),$("#play-state").addClass("play"),$("#play-state").removeClass("pause")),settings.is_loop||$("#control-loop").removeClass("active")}var jplayer_pro=$("#jplayer-pro"),current_sources,sources_id;$(document).ready(function(){$(".sound-item").click(function(){var t=$(this).attr("data-sound");$(this).hasClass("active")?(document.getElementById("sound-"+t).pause(),$("#sound-"+t).removeClass("active"),$(this).removeClass("active")):(document.getElementById("sound-"+t).play(),document.getElementById("sound-"+t).volume=settings.se_volume,$("#sound-"+t).addClass("active"),$(this).addClass("active"))}),jplayer_pro.jPlayer({ready:function(){},timeupdate:function(t){$("#progress-bar").sGlide({startAt:t.jPlayer.status.currentPercentAbsolute})},play:function(){start_sound_effect()},pause:function(){stop_sound_effect()},ended:function(){"album"==params.type?$("#control-next").click():settings.is_loop?$(this).jPlayer("play"):($("#play-state").click(),$("#progress-bar").sGlide({startAt:0}))},error:function(){params.total_sources>1&&(current_sources=params.sources[1],load_sources())},supplied:"mp3",wmode:"window",cssSelectorAncestor:"#control-container"}),$(".volume-level").click(function(){var t=$(this).attr("data-value");volume_sound_effect(t)}),$(".pc-auto").click(function(){$(this).hasClass("disable")?settings.auto_play=!0:settings.auto_play=!1,$.cookie("player_settings",JSON.stringify(settings),{expires:365,path:"/"})}),$("#play-state").click(function(){$(this).hasClass("pause")?($(this).removeClass("pause"),$(this).addClass("play"),jplayer_pro.jPlayer("pause")):($(this).removeClass("play"),$(this).addClass("pause"),jplayer_pro.jPlayer("play"))}),$("#control-loop").click(function(){$(this).toggleClass("active"),$(this).hasClass("active")&&(settings.is_loop=!0),$.cookie("player_settings",JSON.stringify(settings),{expires:365,path:"/"})}),$("#control-random").click(function(){$(this).toggleClass("active")}),$("#progress-bar").sGlide({drag:function(t){jplayer_pro.jPlayer("playHead",t.percent)}}),$("#volume-bar").sGlide({startAt:100,drag:function(t){jplayer_pro.jPlayer("volume",t.percent/100)}}),$(".song-item").click(function(){$(".item").removeClass("active"),$(this).parent().addClass("active");var t=$(this).attr("data-song-id");play_song(t)}),$("#control-next").click(function(){var t=$(".play-list .song-item").index($("#song-"+params.current_song_id)),e=$(".play-list .song-item").get(parseInt(t)+1);if(e)e.click();else{var s=$(".play-list .song-item").first();s.click()}}),$("#control-prev").click(function(){var t=$(".play-list .song-item").index($("#song-"+params.current_song_id)),e=$(".play-list .song-item").get(parseInt(t)-1);if(e)e.click();else{var s=$(".play-list .song-item").last();s.click()}})});