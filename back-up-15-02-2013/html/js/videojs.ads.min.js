!function(t,e,n){"use strict";var a=e.getComponent("Html5").Events,s=function(n){if(!n.ads.cancelPlayTimeout){if(e.browser.IS_IOS){var a=n.currentWidth?n.currentWidth():n.width(),s=n.currentHeight?n.currentHeight():n.height(),o=document.createElement("div");o.style.width=a+"px",o.style.height=s+"px",o.style.background="black",n.el_.parentNode.insertBefore(o,n.el_),n.el_.style.display="none",n.one(["adplaying","adtimeout","adserror","adscanceled","adskip","contentplayback"],function(){n.el_.style.display="block",o.remove()})}n.ads.cancelPlayTimeout=t.setTimeout(function(){n.ads.cancelPlayTimeout=null,n.paused()||n.pause(),n.one("contentplayback",function(){n.paused()&&n.play()})},1)}},o=function(t){var n;n=e.browser.IS_IOS&&t.ads.isLive(t)&&t.seekable().length>0?t.currentTime()-t.seekable().end(0):t.currentTime();var a,s,o=t.$(".vjs-tech"),r=t.remoteTextTracks?t.remoteTextTracks():[],i=[],d={ended:t.ended(),currentSrc:t.currentSrc(),src:t.src(),currentTime:n,type:t.currentType()};for(o&&(d.nativePoster=o.poster,d.style=o.getAttribute("style")),s=r.length;s--;)a=r[s],i.push({track:a,mode:a.mode}),a.mode="disabled";return d.suppressedTracks=i,d},r=function(a,s){if(a.ads.disableNextSnapshotRestore===!0)return void(a.ads.disableNextSnapshotRestore=!1);var o,r=a.$(".vjs-tech"),i=20,d=s.suppressedTracks,c=function(){for(var t=d.length;t--;)o=d[t],o.track.mode=o.mode},u=function(){var t;e.browser.IS_IOS&&a.ads.isLive(a)?s.currentTime<0&&(t=a.seekable().length>0?a.seekable().end(0)+s.currentTime:a.currentTime(),a.currentTime(t)):a.currentTime(s.ended?a.duration():s.currentTime),s.ended||a.play()},l=function(){return a.off("contentcanplay",l),a.ads.tryToResumeTimeout_&&(a.clearTimeout(a.ads.tryToResumeTimeout_),a.ads.tryToResumeTimeout_=null),r=a.el().querySelector(".vjs-tech"),r.readyState>1?u():r.seekable===n?u():r.seekable.length>0?u():void(i--?t.setTimeout(l,50):!function(){try{u()}catch(t){e.log.warn("Failed to resume the content after an advertisement",t)}}())};s.nativePoster&&(r.poster=s.nativePoster),"style"in s&&r.setAttribute("style",s.style||""),a.ads.videoElementRecycled()?(a.one("contentloadedmetadata",c),a.src({src:s.currentSrc,type:s.type}),a.load(),a.one("contentcanplay",l),a.ads.tryToResumeTimeout_=a.setTimeout(l,2e3)):a.ended()&&s.ended||(c(),a.play())},i=function(t){var e=t.$(".vjs-tech");e&&e.removeAttribute("poster")},d={timeout:5e3,prerollTimeout:100,postrollTimeout:100,debug:!1,stitchedAds:!1},c=function(c){var u,l=this,p=e.mergeOptions(d,c);!function(){var t=a.concat(["firstplay","loadedalldata"]),e=function(){return!0},n=function(t,n){n.isImmediatePropagationStopped=e,n.cancelBubble=!0,n.isPropagationStopped=e,l.trigger({type:t+n.type,state:l.ads.state,originalEvent:n})};l.on(t,function(t){if("ad-playback"===l.ads.state)(l.ads.videoElementRecycled()||l.ads.stitchedAds())&&n("ad",t);else if("content-playback"===l.ads.state&&"ended"===t.type)n("content",t);else if("content-resuming"===l.ads.state){if(l.ads.snapshot){if(l.currentSrc()!==l.ads.snapshot.currentSrc){if("loadstart"===t.type)return;return n("content",t)}if(l.ads.snapshot.ended)return"pause"===t.type||"ended"===t.type?void l.addClass("vjs-has-started"):n("content",t)}"playing"!==t.type&&n("content",t)}})}(),l.on(["addurationchange","adcanplay"],function(){l.currentSrc()!==l.ads.snapshot.currentSrc&&l.play()}),l.on("nopreroll",function(){l.ads.nopreroll_=!0}),l.on("nopostroll",function(){l.ads.nopostroll_=!0}),l.ads={state:"content-set",disableNextSnapshotRestore:!1,startLinearAdMode:function(){"preroll?"!==l.ads.state&&"content-playback"!==l.ads.state&&"postroll?"!==l.ads.state||l.trigger("adstart")},endLinearAdMode:function(){"ad-playback"===l.ads.state&&(l.trigger("adend"),l.removeClass("vjs-ad-loading"))},skipLinearAdMode:function(){"ad-playback"!==l.ads.state&&l.trigger("adskip")},stitchedAds:function(t){return t!==n&&(this._stitchedAds=!!t),this._stitchedAds},videoElementRecycled:function(){var t,e;return this.snapshot?(t=l.src()!==this.snapshot.src,e=l.currentSrc()!==this.snapshot.currentSrc,t||e):!1},isLive:function(t){return t.duration()===1/0?!0:"8"===e.browser.IOS_VERSION&&0===t.duration()},shouldPlayContentBehindAd:function(t){return!e.browser.IS_IOS&&!e.browser.IS_ANDROID&&t.duration()===1/0}},l.ads.stitchedAds(p.stitchedAds),u=function(n){var a={"content-set":{events:{adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="ads-ready"},play:function(){this.state="ads-ready?",s(l),i(l)},adserror:function(){this.state="content-playback"},adskip:function(){this.state="content-playback"}}},"ads-ready":{events:{play:function(){this.state="preroll?",s(l)},adskip:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"preroll?":{enter:function(){l.ads.nopreroll_?(l.trigger("readyforpreroll"),t.setTimeout(function(){l.trigger("nopreroll")},1)):(l.addClass("vjs-ad-loading"),l.ads.adTimeoutTimeout=t.setTimeout(function(){l.trigger("adtimeout")},p.prerollTimeout),l.trigger("readyforpreroll"))},leave:function(){t.clearTimeout(l.ads.adTimeoutTimeout),l.removeClass("vjs-ad-loading")},events:{play:function(){s(l)},adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"},nopreroll:function(){this.state="content-playback"}}},"ads-ready?":{enter:function(){l.addClass("vjs-ad-loading"),l.ads.adTimeoutTimeout=t.setTimeout(function(){l.trigger("adtimeout")},p.timeout)},leave:function(){t.clearTimeout(l.ads.adTimeoutTimeout),l.removeClass("vjs-ad-loading")},events:{play:function(){s(l)},adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="preroll?"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ad-playback":{enter:function(){l.ads.shouldPlayContentBehindAd(l)||(this.snapshot=o(l)),l.ads.shouldPlayContentBehindAd(l)&&(this.preAdVolume_=l.volume(),l.volume(0)),l.addClass("vjs-ad-playing"),i(l),l.ads.cancelPlayTimeout&&t.setTimeout(function(){t.clearTimeout(l.ads.cancelPlayTimeout),l.ads.cancelPlayTimeout=null},1)},leave:function(){l.removeClass("vjs-ad-playing"),l.ads.shouldPlayContentBehindAd(l)||r(l,this.snapshot),l.ads.shouldPlayContentBehindAd(l)&&l.volume(this.preAdVolume_)},events:{adend:function(){this.state="content-resuming"},adserror:function(){this.state="content-resuming",l.trigger("adend")}}},"content-resuming":{enter:function(){this.snapshot&&this.snapshot.ended&&(t.clearTimeout(l.ads._fireEndedTimeout),l.ads._fireEndedTimeout=t.setTimeout(function(){l.trigger("ended")},1e3))},leave:function(){t.clearTimeout(l.ads._fireEndedTimeout)},events:{contentupdate:function(){this.state="content-set"},contentresumed:function(){this.state="content-playback"},playing:function(){this.state="content-playback"},ended:function(){this.state="content-playback"}}},"postroll?":{enter:function(){this.snapshot=o(l),l.ads.nopostroll_?t.setTimeout(function(){l.ads.state="content-resuming",l.trigger("ended")},1):(l.addClass("vjs-ad-loading"),l.ads.adTimeoutTimeout=t.setTimeout(function(){l.trigger("adtimeout")},p.postrollTimeout))},leave:function(){t.clearTimeout(l.ads.adTimeoutTimeout),l.removeClass("vjs-ad-loading")},events:{adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-resuming",t.setTimeout(function(){l.trigger("ended")},1)},adtimeout:function(){this.state="content-resuming",t.setTimeout(function(){l.trigger("ended")},1)},adserror:function(){this.state="content-resuming",t.setTimeout(function(){l.trigger("ended")},1)},contentupdate:function(){this.state="ads-ready?"}}},"content-playback":{enter:function(){l.ads.cancelPlayTimeout&&(t.clearTimeout(l.ads.cancelPlayTimeout),l.ads.cancelPlayTimeout=null),l.trigger({type:"contentplayback",triggerevent:l.ads.triggerevent})},events:{adsready:function(){l.trigger("readyforpreroll")},adstart:function(){this.state="ad-playback"},contentupdate:function(){l.paused()?this.state="content-set":this.state="ads-ready?",this.snapshot&&this.snapshot.ended&&(this.snapshot=null)},contentended:function(){l.ads.snapshot&&l.ads.snapshot.ended||(this.state="postroll?")},play:function(){l.currentSrc()!==l.ads.contentSrc&&s(l)}}}};!function(t){var s=function(){};((a[t].events||{})[n.type]||s).apply(l.ads),t!==l.ads.state&&(l.ads.triggerevent=n.type,(a[t].leave||s).apply(l.ads),(a[l.ads.state].enter||s).apply(l.ads),p.debug&&e.log("ads",l.ads.triggerevent+" triggered: "+t+" -> "+l.ads.state))}(l.ads.state)},l.on(a.concat(["adtimeout","contentupdate","contentplaying","contentended","contentresumed","adsready","adserror","adscanceled","adstart","adend","adskip","nopreroll"]),u),l.ads.contentSrc=l.currentSrc(),function(){var e=function(){var t;"ad-playback"!==l.ads.state&&(t=l.currentSrc(),t!==l.ads.contentSrc&&(l.trigger({type:"contentupdate",oldValue:l.ads.contentSrc,newValue:t}),l.ads.contentSrc=t))};l.on("loadstart",e),t.setTimeout(e,1)}(),l.paused()||u({type:"play"})};e.plugin("ads",c)}(window,videojs);